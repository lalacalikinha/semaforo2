<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semaforo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body {
            min-height: 100vh;
            background-size: cover;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        section {
            position: relative;
            height: auto;
            width: auto;
            border-radius: 15px;
            overflow: hidden;
            background-color: #d1d1d1c0;
            padding: 20px; 
            animation: fadeIn 1s ease;
        }
        .border-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100%);
            height: calc(100%);
            border-radius: 15px;
            border: 3px solid transparent;
            animation: animateBorder 5s linear infinite;
        }
        @keyframes animateBorder {
            0% {
                border-color: #ff0000;
            }
            25% {
                border-color: #00ff00;
            }
            50% {
                border-color: #0000ff;
            }
            75% {
                border-color: #ffff00;
            }
            100% {
                border-color: #ff00ff;
            }
        }
        #legenda, #glitter {
            text-align: center;
            margin-bottom: 20px;
        }
        img {
            margin: 20px auto;
            display: block;
            max-width: 100%;
            height: 60%;
            width: 60%;
        }
        h3{
            color: #232323;
        }
        @media (max-width: 576px) {
            section {
                max-width: 90%; 
                margin: 10px;
            }
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <section>
        <div class="border-animation"></div>
            <div id="legenda"></div>
            <div id="glitter"></div>
        
    </section>

    <script>
        let legenda = document.getElementById("legenda");
        let glitter = document.getElementById("glitter");
        let currentStatus = '';

        function updateStatus() {
            fetch("https://niloweb.com.br/transit-room/api/reg_endpoint.php")
            .then(resposta=>resposta.json())
            .then(dados1=>{
                const newStatus = dados1[0].res;
                if (newStatus !== currentStatus) {
                    currentStatus = newStatus;
                    if(currentStatus=="B"){
                        legenda.innerHTML = `<h3>No momento está bloqueado</h3>`;
                        glitter.innerHTML = `<img src="images/vermelha.png" alt="">`;
                        document.body.style.backgroundImage = "url('images/glittervermelho.jpg')";
                        playSound();
                    } else if(currentStatus=="L"){
                        legenda.innerHTML = `<h3>No momento está livre</h3>`;
                        glitter.innerHTML = `<img src="images/verde.png" alt="">`;
                        document.body.style.backgroundImage = "url('images/verdefundo.avif')";
                        playSound();
                    } else {
                        legenda.innerHTML = `<h3>No momento está no aguardo</h3>`;
                        glitter.innerHTML = `<img src="images/amarela.png" alt="">`;
                        document.body.style.backgroundImage = "url(images/fundo2.jpg)";
                        playSound();
                    }
                    showSection();
                }
            });
        }
        updateStatus();
        setInterval(updateStatus, 1000);

        function playSound() {
            const audio = new Audio('som/mario.mp3');
            audio.onended = function() {
            };
            audio.play();
        }

        function showSection() {
            document.getElementById('legenda').classList.add('show');
            document.getElementById('glitter').classList.add('show');
        }
    </script>
</body>
</html>
